# $Id: PKGBUILD 182667 2013-04-12 14:07:12Z andyrtr $
# Maintainer: Andreas Radke <andyrtr@archlinux.org>
# Contributor: Tom Newsom <Jeepster@gmx.co.uk>

# 03-05-2013 Raspi-Build: Maciej Szeptuch (Neverous) <neverous@neverous.info>
#   - disabled tcl and doc

pkgbase="sqlite"
pkgname=('sqlite') 
_amalgamationver=3071602
_docver=${_amalgamationver}
#_docver=3071601
pkgver=3.7.16.2
pkgrel=1
pkgdesc="A C library that implements an SQL database engine"
arch=('armv6zk')
license=('custom')
url="http://www.sqlite.org/"
makedepends=('readline')
source=( # tarball containing the amalgamation for SQLite >= 3.7.5 together with a configure script and makefile for building it; includes now also the Tcl Extension Architecture (TEA)
    http://www.sqlite.org/2013/sqlite-autoconf-$_amalgamationver.tar.gz
    http://www.sqlite.org/2013/sqlite-doc-${_docver}.zip
    license.txt)
options=('!libtool' '!emptydirs')
sha1sums=('85bf857cf86f34831d55d7ba97606dba581b8d62'
          '998df3d9ada4a4a8a048bcf20613d1d02be77731'
          'f34f6daa4ab3073d74e774aad21d66878cf26853')

build() {
    export CFLAGS="$CFLAGS -DSQLITE_ENABLE_FTS3=1 -DSQLITE_ENABLE_COLUMN_METADATA=1 -DSQLITE_ENABLE_UNLOCK_NOTIFY -DSQLITE_SECURE_DELETE"

    # build sqlite
    cd "$srcdir"/sqlite-autoconf-$_amalgamationver
    ./configure --prefix=/usr \
        --disable-static
    make
}

package_sqlite() {
    pkgdesc="A C library that implements an SQL database engine"
    depends=('readline')
    provides=("sqlite3=$pkgver")
    replaces=("sqlite3")
 
    cd ${srcdir}/sqlite-autoconf-$_amalgamationver
    make DESTDIR=${pkgdir} install

    # license
    install -D -m644 ${srcdir}/license.txt ${pkgdir}/usr/share/licenses/${pkgname}/license.txt
}
